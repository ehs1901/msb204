---
title: "Analyse av pendlevaner og trafikkutvikling på Haugalandet"
format: pdf
editor: visual
---

**MSB204 Transportmodeller og regionalutvikling**

**Hanna Sundal Bjerkreim, Henriette Hansen, Ingrid Strømme & Emilie Hansen Sørhaug**

```{r}
#| label: setup 
#| echo: false
#| output: false
library(tidyverse)
library(readr)
library(readxl)
library(dplyr)
library(stringr)
library(nnet)
library(broom)
library(knitr)
```

## **1.0 Introduksjon**

Arbeidsreisen utgjør en vesentlig del av daglige reisevaner og spiller en sentral rolle i transportøkonomiske analyser.
Arbeidsreisen kan gjennomføres på flere måter, som for eksempel til fots, med sykkel, privatbil, kollektivtransport eller andre transportmidler.
Valg av transportmiddel for arbeidreisen påvirkes av en rekke faktorer, der i blant bosted og arbeidssted.
Pendling reflekterer samspillet mellom bostedsvalg og arbeidsplassens beliggenhet, og har stor betydning for trafikkbelastning og transportinfrastruktur.

Formålet med denne oppgaven er å studere pendlevaner og trafikkutvikling på Haugalandet.
Første del av oppgaven tar sikte på å analysere pendledata på Haugalandet ut i fra innsamlede data fra et spørreskjema.
Det skisseres videre en modell for å analysere sannsynligheten for å velge ulike reisemåter for arbeidsreisen.
Det vil videre diskuteres hvilke faktorer myndighetene kan og bør gjøre noe med for å påvirke kjøretøysvalg i en samfunnsøkonomisk ønsket retning.
I andre del av oppgaven studeres trafikkdata fra ulike målestasjoner på Haugalandet for å vurdere trafikkmønstre og utvikling over tid.

## **2.0 Pendlevaner på Haugalandet**

I den første delen av oppgaven skal vi se nærmere på pendlevaner på Haugalandet.
Pendlevaner omfatter ulike aspekter ved arbeidsreisen, inkludert valg av transportmiddel, reiseavstand, og frekvensen av reiser.
Regionen er preget av både urbane og rurale områder, noe som kan påvirke reisevaner og transportmuligheter.

### 2.1 Data

Dataene som benyttes i oppgaven er tverrsnittsdata, innsamlet gjennom et spørreskjema.
Vi benyttet spørreskjemaene om reisevaner på Haugalandet, utarbeidet av studentene i MSB204 høsten 2022, som et utgangspunkt for vår egen spørreundersøkelse.
Vi gjorde flere justeringer ved å legge til nye spørsmål og fjerne de som vi vurderte som mindre relevante.
Vi har vært noe uheldig med endringene vi gjorde, da vår egen spørreundersøkelse er blitt noe ulik den fra 2022.
Dette har gjort det vanskelig å slå sammen datasettene, da spørsmålene er utformet ulikt og dermed ikke direkte sammenlignbare.
Vi innser at vi var litt korttenkte i denne prosessen, noe som har skapt utfordringer i analysen av dataene.
Til tross for disse utfordringene har vi gjort vårt beste for å kombinere dataene fra vår egen spørreundersøkelse med dataene fra 2022.
Resultatet er et samlet datasett med 160 observasjoner, som gir oss et grunnlag for videre analyse av pendlevanene på Haugalandet.

```{r}
#| echo: false
# Laste inn datasett
ny_data <- read_excel("ny_data.xlsx")
tidligere_data <- read_excel("tidligere_data.xlsx")
```

```{r}
#| echo: false
# Fjerne mellomrom og linjeskift fra kolonnenavnene i 'tidligere_data'
colnames(tidligere_data) <- str_trim(gsub("\r\n", "", colnames(tidligere_data)))
```

```{r}
#| echo: false
# Omdøpe variabler i 'tidligere_data' for å matche variablene i 'ny_data'
tidligere_data <- tidligere_data %>%
  rename(
    `Kjønn` = `Hvilket kjønn identifiserer du som?`,  
    `Alder` = `Din alder`,  
    `Utdanning` = `Hva er din høyeste utdanning?`,  
    `Næring` = `I hvilken næring jobber du?`,  
    `Inntektsgruppe` = `Hvilken inntektsgruppe hører du til?`, 
    `Antall_personer_i_husstanden` = `Hvor mange personer bor i din husstand?`,  
    `Antall_med_førerkort` = `Hvor mange i husstanden har førerkort?`,  
    `Transportmåte_disponibelt` = `Hva har du til disposisjon?`,  
    `Hvordan_kommer_du_deg_til_jobb` = `Hva har du reist med siste uken?`,
    `Tid_brukt_til_jobb` = `Hvor lang er din pendletid til jobb?`,
    `Postnummer` = `Hva er ditt postnummer (bosted)`, 
    `Postnummer_arbeidssted` = `Hva er ditt postnummer (arbeidsplass)`,  
    `Fast_oppmøte` = `Har du fast oppmøtested?`,
    `Parkering_ved_jobb` = `Er det gode parkeringsmuligheter nær din arbeidsplass?`
    )
```

```{r}
#| echo: false
# Omdøpe variabler i 'ny_data' for å matche variablene i 'tidligere_data'
ny_data <- ny_data %>%
  rename(
    `Kjønn` = `Hvilket kjønn identifiserer du deg som?`,  
    `Alder` = `Hva er alderen din?`,  
    `Utdanning` = `Hva er din høyeste utdanning?`,  
    `Næring` = `I hvilken næring jobber du?`, 
    `Inntektsgruppe` = `Hvilken inntektsgruppe tilhører du?`,  
    `Antall_personer_i_husstanden` = `Hvor mange bor i din husstand?`,  
    `Antall_med_førerkort` = `Hvor mange har førerkort i din husstand?`,
    `Transportmåte_disponibelt` = `Hvilke muligheter har du tilgjengelig for reise til jobb?`,
    `Hvordan_kommer_du_deg_til_jobb` = `Hvilke muligheter bruker du for å reise til jobb?`,
    `Tid_brukt_til_jobb` = `Hvor lang tid bruker du til jobb`, 
    `Postnummer` = `Hvilket postnummer er din husstand plassert under?`,  
    `Postnummer_arbeidssted` = `Hvilket postnummer er arbeidsplassen din plasser under?`,
    `Fast_oppmøte` = `Har du fast oppmøte til jobb?`, 
    `Parkering_ved_jobb` = `Har du parkeringsmuligheter på jobb?` 
    )
```

```{r}
#| echo: false
# Velge felles variabler i begge datasettene
common_columns <- c("Starttidspunkt", "Kjønn", "Alder", "Utdanning", "Næring", "Inntektsgruppe", "Antall_personer_i_husstanden", "Antall_med_førerkort", "Transportmåte_disponibelt","Hvordan_kommer_du_deg_til_jobb", "Tid_brukt_til_jobb", "Postnummer", "Postnummer_arbeidssted", "Fast_oppmøte", "Parkering_ved_jobb")
```

```{r}
#| echo: false
# Slå sammen datasettene
merged_data <- bind_rows(
  select(ny_data, all_of(common_columns)),
  select(tidligere_data, all_of(common_columns))
  )
```

```{r}
#| echo: false
# Erstatte "Fossil bil" med "Bil (Bensin/Diesel)"
# Erstatte "El-bil" og "Hybrid bil" med "Bil ( Elektrisk/Hybrid)

merged_data <- merged_data %>%
  mutate(`Hvordan_kommer_du_deg_til_jobb` = gsub("\\bFossil bil\\b", "Bil (Bensin / Diesel)", `Hvordan_kommer_du_deg_til_jobb`, ignore.case = TRUE)) %>%
  mutate(`Hvordan_kommer_du_deg_til_jobb` = gsub("\\bHybrid bil\\b", "Bil (Elektrisk / Hybrid)", `Hvordan_kommer_du_deg_til_jobb`, ignore.case = TRUE)) %>%
  mutate(`Hvordan_kommer_du_deg_til_jobb` = gsub("\\bEl-bil\\b", "Bil (Elektrisk / Hybrid)", `Hvordan_kommer_du_deg_til_jobb`, ignore.case = TRUE))

merged_data <- merged_data %>%
  mutate(`Transportmåte_disponibelt` = gsub("\\bFossil bil\\b", "Bil (Bensin / Diesel)", `Transportmåte_disponibelt`, ignore.case = TRUE)) %>%
  mutate(`Transportmåte_disponibelt` = gsub("\\bHybrid bil\\b", "Bil (Elektrisk / Hybrid)", `Transportmåte_disponibelt`, ignore.case = TRUE)) %>%
  mutate(`Transportmåte_disponibelt` = gsub("\\bEl-bil\\b", "Bil (Elektrisk / Hybrid)", `Transportmåte_disponibelt`, ignore.case = TRUE))

# Erstatte "EL sykkel" med "EL-sykkel"
# Erstatte "Ingen av de over" med "Annet"
merged_data <- merged_data %>%
  mutate(Hvordan_kommer_du_deg_til_jobb = gsub("\\bEL sykkel\\b", "El-sykkel", Hvordan_kommer_du_deg_til_jobb, ignore.case = TRUE)) %>%
  mutate(Hvordan_kommer_du_deg_til_jobb = gsub("\\bIngen av de over\\b", "Annet", Hvordan_kommer_du_deg_til_jobb, ignore.case = TRUE))

merged_data <- merged_data %>%
  mutate(Transportmåte_disponibelt = gsub("\\bEL sykkel\\b", "El-sykkel", Transportmåte_disponibelt, ignore.case = TRUE)) %>%
  mutate(Transportmåte_disponibelt = gsub("\\bIngen av de over\\b", "Annet", Transportmåte_disponibelt, ignore.case = TRUE))

```

\

### 2.2 Modell for analyse av pendlevaner

I dette avsnittet skisserer vi en modell for å analysere pendlevaner basert på innsamlede data.
Modellen fokuserer på hvilke faktorer som påvirker sannsynligheten for å velge ulike reisemåter.
Dette med hensyn til både individuelle kjennetegn, særtrekk ved en bestemt kombinasjon av bosted og arbeidsplass, samt egenskaper ved ulike reisemåter.

**multinomial logit-modell?**

### 2.3 Myndighetene og virkemiddel for valg av kjøretøy

Når myndighetene ønsker å påvirke valg av kjøretøy i en samfunnsøkonomisk ønsket retning, er det flere faktorer de kan fokusere på.
De mest effektive tiltakene vil ofte være økonomiske insentiver, reguleringer og bevisstgjøring, som alle kan bidra til å fremme mer bærekraftige valg.
Her er noen av de viktigste faktorene myndighetene kan og bør fokusere på:

**1. Økonomiske insentiver og avgifter:**

-   **Skatteinsentiver for miljøvennlige biler**: Reduksjon i avgifter på elbiler, hybridbiler eller andre lavutslippsbiler, kombinert med høyere avgifter på fossildrevne kjøretøy, kan gjøre miljøvennlige valg økonomisk mer attraktive.
-   **Bompenger og veiavgifter**: Myndighetene kan differensiere bompenger basert på utslipp, slik at biler med høyt CO₂-utslipp betaler mer. Dette vil kunne påvirke valg av kjøretøy mot lavutslippsalternativer.
-   **Subsidier for elektriske biler**: Støtte til innkjøp av elektriske kjøretøy eller tilskudd til hjemmeladere kan redusere den økonomiske terskelen for å velge miljøvennlige kjøretøy.

**2. Infrastrukturutvikling:**

-   **Utbygging av ladestasjoner for elbiler**: Et utvidet nettverk av ladestasjoner vil redusere "rekkeviddeangsten" for elbilkjøpere og gjøre det enklere å velge elektriske kjøretøy.
-   **Tilrettelegging for sykkel og kollektivtransport**: Ved å forbedre og subsidere kollektivtransport, sykkelveier og fotgjengertilgang kan myndighetene redusere avhengigheten av privatbiler, spesielt i byområder.

**3. Reguleringer og lovgivning:**

-   **Utslippsstandarder**: Myndighetene kan innføre strenge utslippskrav for biler, der bilprodusenter pålegges å produsere kjøretøy med lavere utslipp for å møte reguleringer.
-   **Forbud mot fossilbiler**: Etter hvert som teknologi og infrastruktur forbedres, kan myndighetene vurdere å sette en tidsfrist for forbud mot salg av nye fossilbiler, slik som Norge har satt som mål for 2025.

**4. Informasjon og bevisstgjøringskampanjer:**

-   **Opplysningskampanjer**: Myndighetene kan gjennomføre kampanjer for å øke bevisstheten rundt miljøkonsekvensene av bilvalg, og fremme fordeler ved å velge elbiler eller hybridbiler.
-   **Merking av kjøretøy**: Klar og tydelig merking av kjøretøy med hensyn til utslipp, drivstoffeffektivitet og total eierkostnad kan hjelpe forbrukere med å ta mer informerte beslutninger.

**5. Tilgang til spesialtiltak for miljøvennlige kjøretøy:**

-   **Fordeler som gratis parkering og tilgang til kollektivfelt**: Myndighetene kan tilby insentiver som tilgang til kollektivfelt, billigere eller gratis parkering for elbiler og andre miljøvennlige alternativer, noe som gjør dem mer attraktive i hverdagen.

Myndighetene har flere verktøy for å påvirke kjøretøyvalg i en samfunnsøkonomisk ønsket retning.
Kombinasjonen av økonomiske insentiver, infrastrukturtjenester, reguleringer og informasjon kan bidra til å øke andelen miljøvennlige kjøretøy og redusere klimagassutslipp, som igjen har positive samfunnsøkonomiske effekter.

### 2.4 Deskriptiv statistikk

Vi skal nå presentere en deskriptiv oversikt når det gjelder valg av reisemåter for arbeidsreiser på Haugalandet.
Vi skal kommentere kritiske avstander for valg av ulike reisemåter og undersøker om det er systematiske forskjeller etter kjønn, alder, inntekt, utdanning og yrke.

```{r}
#| echo: false
# Splitt transportmåtene som er separert med semikolon
transport_modes <- merged_data %>%
  separate_rows(Hvordan_kommer_du_deg_til_jobb, sep = ";") %>%
  mutate(Hvordan_kommer_du_deg_til_jobb = str_trim(Hvordan_kommer_du_deg_til_jobb))  

# Fjern rader med NA i kolonnen "Hvordan_kommer_du_deg_til_jobb"
transport_modes <- transport_modes %>%
  filter(!is.na(Hvordan_kommer_du_deg_til_jobb))

# Tell antall ganger hver transportmåte har blitt valgt
transport_count <- transport_modes %>%
  group_by(Hvordan_kommer_du_deg_til_jobb) %>%
  summarise(Antall = n()) %>%
  arrange(desc(Antall))

# Vis tabellen med kable
transport_count %>%
  kable(col.names = c("Transportmåte", "Antall"), 
        caption = "Antall personer per transportmåte",
        align = "l")  # Justerer kolonner til venstre

```

###  Emilie har testet å lage en **multinomial logit-modell** (eller chat har testet) :P 

Men eg prøvde å forklara chat at me ønska å laga ein multinomial logit-modell ut i fra både merge_data og den tabellen hanna lagte.
Altså å bruke tabellen som variablen i stedenfor "Hvordan_kommer_du_deg_til_jobb" fra merge_data.
Men det va veldig vanskelig, og mye rare koder som aldri fungerte.
Det gir sikkert meining siden at det ikke ska gå siden observasjonanen i tabellen ikke sammsvare med observasjonene i datasette om dåkker fatte....
?

Derfor foreslo char noe om å slå sammen for eksempel el-sykkel og sykkel som bare sykkel for å redusera antall kategorier og derfor lettare å tolka ein nultinominal logit-modell.
Han ga meg deia kodene:

Resultate fra modellen e fortsatt veldig "stort" og ikke så lett å tolka, men i hvertfall lettare og mer oversiktilig nå enn kan det va før me kombinerte kategoriene.
Når eg spør chat om han kan tolka finne han svar som for eksempel "*En positiv koeffisient for Bil med Alder26-35 betyr at personer i denne aldersgruppen er mer sannsynlig å velge bil sammenlignet med referansekategorien*." og "*En negativ koeffisient for Buss med KjønnMann betyr at menn er mindre sannsynlig å velge buss enn kvinner*."

Chat sa i hvertfall at ein **multinomial logit-modell** va reelt for oss å bruka ...
*"Multinomial logit-modellen egner seg spesielt godt når du har flere alternativer å velge mellom, som i ditt tilfelle – ulike transportmidler (sykkel, buss, bil, elbil osv.). Modellen beregner sannsynligheten for at en person velger en bestemt reisemåte gitt visse faktorer."*

```{r}
merged_data <- merged_data %>%
  mutate(Hvordan_kommer_du_deg_til_jobb = case_when(
    str_detect(Hvordan_kommer_du_deg_til_jobb, "El-sykkel|Sykkel") ~ "Sykkel",
    str_detect(Hvordan_kommer_du_deg_til_jobb, "Bil \\(Bensin / Diesel\\)|Bil \\(Elektrisk / Hybrid\\)") ~ "Bil",
    TRUE ~ Hvordan_kommer_du_deg_til_jobb
  ))
```

```{r}
merged_data <- merged_data %>%
  mutate(Transportmåte_disponibelt = case_when(
    str_detect(Transportmåte_disponibelt, "El-sykkel|Sykkel") ~ "Sykkel",
    str_detect(Transportmåte_disponibelt, "Bil \\(Bensin / Diesel\\)|Bil \\(Elektrisk / Hybrid\\)") ~ "Bil",
    TRUE ~ Transportmåte_disponibelt
  ))
```

```{r}
table(merged_data$Hvordan_kommer_du_deg_til_jobb)
table(merged_data$Transportmåte_disponibelt)
```

```{r}
clean_data <- merged_data %>%
  filter(!is.na(Hvordan_kommer_du_deg_til_jobb), !is.na(Tid_brukt_til_jobb), !is.na(Kjønn), !is.na(Inntektsgruppe), !is.na(Alder), !is.na(Utdanning))
```

```{r}
transport_model <- multinom(Hvordan_kommer_du_deg_til_jobb ~ Tid_brukt_til_jobb + Inntektsgruppe + Alder + Kjønn + Utdanning, data = clean_data)
```

```{r}
summary(transport_model)
```

### 2.5 Resultater

## **3.0 Trafikkutvikling på Haugalandet (*Henriette*)**

### 3.1 Data (*Henriette*)

### 3.2 Årsdøgntrafikk (*Henriette*)

### 3.3 Timetrafikk (*Henriette*)

### 3.4 Resultater (*Henriette*)

## **4.0 Konklusjon**

## **5.0 Referanser**
